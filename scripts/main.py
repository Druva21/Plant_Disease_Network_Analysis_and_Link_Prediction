
import csv, json, os
from lib import run_method

METHODS = [
    ("Common Neighbors", "common_neighbors"),
    ("Jaccard", "jaccard"),
    ("Adamic-Adar", "adamic_adar"),
    ("Resource Allocation", "resource_allocation"),
]

def main():
    rows = []
    for pretty, method in METHODS:
        m = run_method(method)
        print(json.dumps({"method": pretty, **m}, indent=2))
        rows.append([pretty, m["roc_auc"], m["pr_auc"], m["f1"]])
    # Save metrics
    os.makedirs("results", exist_ok=True)
    with open("results/metrics.csv", "w", newline="") as f:
        w = csv.writer(f)
        w.writerow(["Method", "ROC_AUC", "PR_AUC", "F1"])
        for r in rows:
            w.writerow(r)
    # Write summary
    with open("results/results_summary.txt", "w") as f:
        f.write("Results generated by main.py\n")
        for r in rows:
            f.write(f"{r[0]}: ROC_AUC={r[1]:.4f}, PR_AUC={r[2]:.4f}, F1={r[3]:.4f}\n")
    print("Saved results to results/metrics.csv and results/results_summary.txt")

if __name__ == "__main__":
    main()
